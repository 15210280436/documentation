<!DOCTYPE html>
<html>
	    <head>

        <meta charset="utf-8" />

    	<!-- Fonts -->
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//fonts/font-awesome/css/font-awesome.min.css" />
        <link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/plotly_icons.css" />
        <link href="//fonts.googleapis.com/css?family=Open+Sans:600,400,300,200|Inconsolata|Ubuntu+Mono:400,700" rel="stylesheet" type="text/css" />


    	<!-- Stytlesheets -->
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/normalize.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/base.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/layout_block.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/modules.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/state.css">
    	<!-- Download icon for Plotly.js -->
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        
        <link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/api_docs.css">
        

    	<!-- Icon -->
    	<link rel="shortcut icon" href="https://plot.ly/gh-pages/documentation/static//images/plotly-ico.png" type="image/x-icon" />

    	<!-- META TAGS -->
    	<!-- SEO Tags - title, meta_description -->
    <title>User Guide</title>
    <meta name="description" content="UseR Guide for plotly and its R and ggplot2 API Libraries.">

<!-- Bing tags -->
    <meta name="msvalidate.01" content="D319859A832F9F1D15A7646E2A42150A" />
<!-- Facebook tags -->
    <meta property="og:title" content="Plotly UseR Guide"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://plot.ly/gh-pages/documentation/static//images/static-image.png">
    <meta property="og:description" content="UseR Guide for plotly and its R and ggplot2 API Libraries."/>
    <meta property="og:url" />
    <meta property="fb:admins" content="1123751525"/>
    <meta property="fb:admins" content="22418"/>

<!-- twitter tags -->
    <meta name="twitter:card" content="photo" />
    <meta name="twitter:title" content="Plotly UseR Guide"/>
    <meta name="twitter:url" content="http://help.plot.lyr/user-guide/"/>
    <meta name="twitter:description" content="UseR Guide for plotly and its R and ggplot2 API Libraries."/>
    <meta name="twitter:image" content="https://plot.ly/gh-pages/documentation/static//images/static-image.png">
    <meta name="twitter:site" content="@plotlygraphs"/>

<!-- Favicon -->
    <link rel="shortcut icon" href="https://plot.ly/gh-pages/documentation/static//images/plotly-ico.png" />



    	<!-- code highlighting -->
    	<link rel="stylesheet" href="https://plot.ly/gh-pages/documentation/static//javascripts/codehighlight/styles/tomorrow.css">

	<!-- start Mixpanel --><script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
	for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
	mixpanel.init("ad6df61d0b9400400b240631576c24d4");</script><!-- end Mixpanel -->

	</head>

	<head>
	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/state.css">
	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/ipython-notebook-base.css">
	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/ipython-notebook-custom.css">
	</head>

	<body>
		<div class="allcontent">
			<div class="headerbar">

    <div class="headerbar-leftside">
        <a href="https://plot.ly/feed/" class="logo">
            <i class="ploticon-plotlylogo"></i> 
            <em>plotly</em>
        </a>
    </div>

  <div class="headerbar-rightside hidesmall">

      
      <a class="button"
         href="https://plot.ly/plot"
         target="_self">
          NEW PROJECT
      </a>
  </div>

  <div class="headerbar-nav hidesmall">
      <a href="https://plot.ly/plot" class="link --headerbar" target="_self">
      <span class="headerbar-nav-item ">Workspace</span>
      </a>
  
      <a href="https://plot.ly/feed/" class="link --headerbar" target="_self">
      <span class="headerbar-nav-item ">Explore</span>
      </a>
  
      <a href="https://plot.ly/api/" class="link --headerbar" target="_self">
      <span class="headerbar-nav-item ">API</span>
      </a>
  
      <a href="https://plot.ly/product/enterprise/" class="link --headerbar" target="_blank">
      <span class="headerbar-nav-item ">Enterprise</span>
      </a>
  </div>
  
  <div class="hamburger">
		<a href='#popmenufull' onclick='return clickfullmenu();'>
			<img src="http://i.imgur.com/o7Mxj6T.png" alt="Menu" id="hamburgerlink" onmouseover="this.src='http://i.imgur.com/gj2TtuI.png'" onmouseout="this.src='http://i.imgur.com/o7Mxj6T.png'">
		</a>
		
	</div>

</div>

<!-- POP UP MENU -->
	<div id="popmenufull" style="display:none;">	 
			<div class="popupheader">
					<div class="headerbar-leftside">
						<a href="/feed/" class="logo">
							<i class="ploticon-plotlylogo"></i>
							<em>plotly</em>
						</a>
					</div>


					
					<a href='#popmenufull' onclick='return clickfullmenu();'>
					<div class="close"><img alt="close" src="http://i.imgur.com/esVZHwn.png"></div> </a>
			</div>	
						
			<div class="popupmenu">
				<ul>
					<li><a href="https://plot.ly/plot">Workspace</a></li>
					<li><a href="https://plot.ly/feed/">Explore</a></li>
					<li><a href="https://plot.ly/api/">API</a></li>
					<li><a href="https://plot.ly/product/enterprise/">Enterprise</a></li>
				</ul>
			</div>

	</div>

  <!-- POPUP MENU FULL PAGE -->
	<script>
		function clickfullmenu(){
			var thediv=document.getElementById('popmenufull');
			if(thediv.style.display == "none"){
				thediv.style.display = "";
			}else{
				thediv.style.display = "none";
			}
			return false;
				}
	</script>
			<div class="navigation-bar">
<p class="align-left padding_left_small"><a href="/api/"> API Libraries / </a><a href="/r"  >R / </a>Plotly UseR Guide</p>
	<div class="float-right padding_right_small">
		<a id="forklink" href="https://github.com/plotly">Fork on GitHub</a>
	</div>
</div>





			<div class="sectionseparator_white">
				<div class="container">

					

						```{r, echo = FALSE, message=FALSE}
knitr::opts_chunk$set(message = FALSE)
Sys.setenv("plotly_username"="RPlotBot")
Sys.setenv("plotly_api_key"="q0lz6r5efr")
```
# Plotly UseR Guide

Version 1.0.0 of the [plotly R package](https://github.com/ropensci/plotly) introduces a new high-level interface for working with plotly's JavaScript graphing library from R. The aim of this vignette is to explain the semantics of this interface, but I also recommend perusing [plotly's R homepage](https://plot.ly/r/) for more examples.

To initiate a plotly object, use `plot_ly()`. Here we turn the `economics` data frame (from the ggplot2 package) into a plotly visualization and store it as the object `p`.

```{r, message=FALSE}
library(plotly)
p <- plot_ly(economics, x = date, y = uempmed)
```

If you have a plotly account, printing plotly objects in the R console will create a new plotly figure, and open it in your web browser. If you're using knitr/R Markdown with HTML output (like [this vignette](https://github.com/ropensci/plotly/tree/master/vignettes/intro.Rmd)), printing not only creates the plot, but also embeds it as an HTML iframe.

```{r, message=FALSE}
p
```

`plot_ly()` has a number of arguments which are unique to the R package and make common visualizations a bit easier. These arguments are very much inspired by the semantics of ggplot2's `qplot()` in the sense that a scales are automatically applied these variables (i.e., they map data to visual properties).

#### Qualitative color mappings

If a ordinal variable (aka a non-ordered factor variable) is assigned to color, then a qualitative color palette is used by default.

```{r, message=FALSE}
plot_ly(iris, x = Petal.Length, y = Petal.Width,
        color = Species, mode = "markers")
```

If you want to change the default palette, it's recommended that you provide a <http://colorbrewer2.org> qualitative pallette name (e.g., "Set1" or "Accent") to the colors argument.

```{r, message=FALSE}
plot_ly(iris, x = Petal.Length, y = Petal.Width,
        color = Species, colors = "Set1", mode = "markers")
```

In this case, the palette consists of 9 colors and the default behavior is to pick colors that are furthest apart ("#E41A1C", "#FF7F00", and "#999999").

```{r, eval=FALSE}
cols <- RColorBrewer::brewer.pal(9, "Set1")
scales::show_col(cols)
```

<div align="center">
  <a href="http://imgur.com/PpLch1T">
    <img src="http://i.imgur.com/PpLch1T.png" />
  </a>
</div>

If you'd like more control over the mapping, you can provide a vector of colors (of appropriate length).

```{r, message=FALSE}
cols <- RColorBrewer::brewer.pal(nlevels(iris$Species), "Set1")
plot_ly(iris, x = Petal.Length, y = Petal.Width,
        color = Species, colors = cols, mode = "markers")
```

#### Sequential color mappings

If either a numeric or an ordered factor is mapped to color, `plot_ly()` applies a sequential color scale by default.

```{r, message=FALSE}
plot_ly(iris, x = Petal.Length, y = Petal.Width,
        color = as.ordered(Species), mode = "markers")
```

In the case of continuous numeric variables, `plot_ly()` performs a linear mapping between the data and an interpolated color pallette.

```{r, message=FALSE}
plot_ly(iris, x = Petal.Length, y = Petal.Width,
        color = Sepal.Length, mode = "markers")
```

The colors argument takes arbitrary color codes of arbitrary length. Here is how we could use it to replicate the default mapping in ggplot2.

```{r, message=FALSE}
plot_ly(iris, x = Petal.Length, y = Petal.Width,
        color = Sepal.Length, colors = c("#132B43", "#56B1F7"),
        mode = "markers")
```

#### Diverging color mappings

To obtain a diverging color mapping, just provide a diverging palette to the colors argument.

```{r, message=FALSE}
plot_ly(iris, x = Petal.Length, y = Petal.Width,
        color = Sepal.Length, colors = "PuOr", mode = "markers")
```

#### The symbol argument

To encode values using symbols, use the symbol argument.

```{r, message=FALSE}
plot_ly(iris, x = Petal.Length, y = Petal.Width,
        symbol = Species, mode = "markers")
```

To change the default symbols used, use the symbols argument. [View all of the available symbol](https://plot.ly/r/reference/#marker).

```{r, message=FALSE}
plot_ly(iris, x = Petal.Length, y = Petal.Width, mode = "markers",
        symbol = Species, symbols = c("cross", "square", "triangle-down"))
```

### The group argument and `subplot()`

Using the group argument splits the data into different plotly "traces".

```{r, message=FALSE}
plot_ly(iris, x = Petal.Length, y = Petal.Width,
        group = Species, mode = "markers")
```

Although we haven't specified a coloring scheme, plotly will employ one on it's own default scheme. The group argument is quite powerful when used in conjunction with `subplot()` in order to anchor traces onto different axes.

```{r, message=FALSE}
iris$id <- as.integer(iris$Species)
p <- plot_ly(iris, x = Petal.Length, y = Petal.Width, group = Species,
             xaxis = paste0("x", id), mode = "markers")
subplot(p)
```

Since `subplot()` does not assume x/y axes are on a common scale, it does not impose any restrictions on the range by default. However, you can change this by pre-specifying the range of the [axis objects](https://plot.ly/r/reference/#xaxis) via the `layout()` function.

```{r, message=FALSE}
p2 <- layout(
  p,
  xaxis = list(range = range(Petal.Length) + c(-0.1, 0.1)),
  yaxis = list(range = range(Petal.Width) + c(-0.1, 0.1))
)
subplot(p2)
```

The `subplot()` function creates "xaxis[0-9]" objects which inherit pre-specified properties, but you can also customize each subplot by referencing these objects in the layout

```{r, message=FALSE}
layout(
    subplot(p2),
    yaxis2 = list(title = ""),
    yaxis3 = list(title = "")
)
```

[See here](https://plot.ly/r/map-subplots-and-small-multiples/) for another example of using the group argument to make small multiples (with maps!).

### Manually adding traces

Sometimes you may want multiple traces on a plot, but have different traces from different data sources. In this case, the `add_trace()` function and it's (optional) `data` argument come in handy.

```{r, message=FALSE}
m <- loess(uempmed ~ as.numeric(date), economics)
efit <- data.frame(date = economics$date, yhat = fitted(m))

plot_ly(economics, x = date, y = uempmed, name = "observed") %>%
  add_trace(y = yhat, name = "estimated", data = efit)
```

Note that the date information carries over from the first trace to the second. In fact, by default, information from the first trace carries over to all subsequent traces unless the property is overwritten or if we set `inherit = FALSE` in `plot_ly()` (this helps [avoid repeating yourself](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)).

### Mixing data manipulation and visualization verbs

If you look at the structure of plotly objects, they are actually data frames with a class of plotly and a special environment attached (this environment tracks the mapping from data to visual properties).

```{r, eval = TRUE}
str(p <- plot_ly(economics, x = date, y = uempmed))
```

Doing this allows us to mix data manipulation and visualization verbs in a [pure(ly) functional, predictable and pipeable](https://dl.dropboxusercontent.com/u/41902/pipe-dsls.pdf) manner. Here, we take advantage of [dplyr](http://cran.r-project.org/web/packages/dplyr/index.html)'s `filter()` verb to label the highest peak in the time series:

```{r, message = FALSE, warning = FALSE}
p %>%
  add_trace(y = fitted(loess(uempmed ~ as.numeric(date)))) %>%
  layout(title = "Median duration of unemployment (in weeks)",
         showlegend = FALSE) %>%
  dplyr::filter(uempmed == max(uempmed)) %>%
  layout(annotations = list(x = date, y = uempmed, text = "Peak", showarrow = T))
```

Although data frames can be thought of as the central object in this package, plotly visualizations don't actually _require_ a data frame. This makes chart types that accept a `z` argument especially easy to use if you have a numeric matrix:

```{r, message=FALSE}
plot_ly(z = volcano, type = "surface")
```

				</div>
			</div>
		</div>
    <footer>
<div class="plotly-footer">
	<div class="row footerarea footer-top">
		<div class="one column footcolumn space"> </div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">API</h6>
			<ul>
				<li><a  href="https://plot.ly/api/" target="_self">Documentation</a></li>
				<li><a  href="https://plot.ly/api/" target="_self">API Libraries</a></li>
				<li><a  href="https://plot.ly/rest/" target="_self">REST APIs</a></li>
				<li><a  href="https://plot.ly/javascript-graphing-library/" target="_self">Plotly.js</a></li>
				<li><a  href="https://plot.ly/workshop/" target="_self">Hardware</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">About Us</h6>
			<ul>
				<li><a href="https://plot.ly/company/team/" target="_self">Team</a></li>
				<li><a href="https://plot.ly/company/jobs/" target="_self">Careers</a></li>
				<li><a href="http://blog.plot.ly" target="_blank">Plotly Blog</a></li>
				<li><a href="http://moderndata.plot.ly" target="_blank">Modern Data</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">Help</h6>
			<ul>
				<li><a href="https://plot.ly/learn/" target="_self">Knowledge Base</a></li>
				<li><a href="https://plot.ly/benchmarks/" target="_self">Benchmarks</a></li>
				<li><a href="https://plot.ly/workshop/" target="_self">Workshop</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">Solutions</h6>
			<ul>
				<li><a href="https://plot.ly/product/plans/" target="_self">Plans &amp; Pricing</a></li>
				<li><a href="https://plot.ly/product/enterprise/" target="_self">Enterprise</a></li>
				<li><a href="https://plot.ly/online-graphing-and-statistics-for-educators/" target="_self">Education</a></li>
				<li><a href="https://plot.ly/product/plotlyjs/" target="_self">Plotly.js</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">	
     		<h6 class="footer-heading">Connect</h6>
			<ul class="plotly-social-media-small">
				<li><a href="//twitter.com/plotlygraphs" target="_blank"><i class="icon-twitter social_icon"></i></a></li>
				<li><a href="//www.facebook.com/Plotly" target="_blank"><i class="icon-facebook social_icon"></i></a></li>
				<li><a href="//github.com/plotly" target="_blank"><i class="icon-github social_icon"></i></a></li>
				<li><a href="//linkedin.com/company/plotly" target="_blank"><i class="icon-linkedin social_icon"></i></a></li>
				<li><a href="//plus.google.com/+PlotLy" target="_blank"><i class="icon-google-plus  social_icon"></i></a></li>
			</ul>
		</div>
		<div class="one column footcolumn"></div>
	</div>
	
	<div class="row footerarea footer-bottom">
		<div class="one column footcolumn space"> </div>
		<div class="four columns footcolumn"><p>Copyright &copy; 2015 Plotly. All rights reserved.</p></div>
		<div class="two columns footcolumn"><a href="https://plot.ly/terms-of-service/" target="_blank" ><p>Terms of Service</p></a></div>
		<div class="two columns footcolumn"><a href="https://plot.ly/privacy/" target="_blank"><p>Privacy Policy</p></a></div>
		
		
	</div>
</div>
</footer>


<script type='text/x-mathjax-config'>
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true}});
</script>

<script type='text/javascript' src='//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML%2CSafe.js&#038;ver=4.1'></script>

	<!-- Image Hover Script -->
  	<script src="https://plot.ly/gh-pages/documentation/static//javascripts/imghover.js"></script>
	
	<!-- code highlighting -->
	<script src="https://plot.ly/gh-pages/documentation/static//javascripts/codehighlight/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>



	</body>
</html>
