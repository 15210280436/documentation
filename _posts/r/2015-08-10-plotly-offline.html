---
permalink: /r/offline
description: How to use Plotly offline using the Plotly R client, ggplot2, and RStudio
name: Plotly Offline for Plotlys R Library
has_thumbnail: false
thumbnail: /images/static-image
layout: user-guide
page_type: u-guide
language: r
---
{% raw %}
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Plotly-Offline-for-R">Plotly Offline for RStudio and Shiny<a class="anchor-link" href="#Plotly-Offline-for-R">&#182;</a></h1><p><strong>NEW: Plotly's R library v.1.0 renders Plotly graphs offline in RStudio.</strong></p>

<img src="http://i.imgur.com/DgFP9oZ.gif">
<br>

<ul>
<li>Plotly R figures will appear interactively within RStudio's graphics viewer without internet connection.</li>
</ul>
<ul>
<li>When your ready to share, you can just publish them to the <a href="https://plot.ly/feed">Plotly Cloud</a> or to your company's internal <a href="https://plot.ly/product/enterprise">Plotly Enterprise</a>.</li>
</ul>
<ul>
<li>To get started with Plotly Offline, <a href="http://purchasing.plot.ly/plotly-offline-r">start a trial</a> or contact <a href=\"mailto:sales@plot.ly\">sales@plot.ly</a> to learn about licensing and receive a URL to download the package.</li>
</ul>
<h3 id="Getting-Started">Getting Started<a class="anchor-link" href="#Getting-Started">&#182;</a></h3><p>1 - Update the Plotly R Library so that your version is at least v.1.0. In RStudio, run</p>

<pre><code>devtools::install_github("ropensci/plotly")</code></pre>

<p>2 - Download the offline Plotly bundle. Obtain a license url by <a href="http://purchasing.plot.ly">starting a trial</a> or contacting <a href=\"mailto:sales@plot.ly\">sales@plot.ly</a></p>

<pre><code>dir.create('~/.plotly/plotlyjs', recursive=TRUE)

download.file("http://purchasing.plot.ly/your_licensed_plotly_offline_url", 
  "~/.plotly/plotlyjs/plotly-offline.zip")

unzip("~/.plotly/plotlyjs/plotly-offline.zip", exdir = "~/.plotly/plotlyjs")
</code></pre>

<p>
If, for some reason, you can't move the zip file to that location, tell R to look elsewhere by changing the "plotly_offline" environment variable (in this case, you may want to place this snippet in your ~/.Rprofile). For example:  
</p>

<pre><code>download.file("http://purchasing.plot.ly/your_licensed_plotly_offline_url", 
  "~/Downloads/plotly-offline.zip")

unzip("~/Downloads/plotly-offline.zip", exdir = "~/Downloads/")

Sys.setenv("plotly_offline"="~/Downloads/")
</code></pre>

<p>3 - Now, you are ready to start using Plotly offline! All you need to do is wrap your <code>plot_ly</code> or <code>ggplotly</code> calls in <code>offline</code></p>

<pre><code>library(plotly)
set.seed(100)
d <- diamonds[sample(nrow(diamonds), 1000), ]
p <- plot_ly(d, x = carat, y = price, text = paste("Clarity: ", clarity),
        mode = "markers", color = carat, size = carat)
offline(p)
</code></pre>

<p>Alternatively, pipe the calls into <code>offline.</code></p>

<pre><code>p %>% offline
</code></pre>

<p>Your graphs will appear in the R Studio viewer:</p>

<img src="http://i.imgur.com/DgFP9oZ.gif">
<br>

<p>You can also construct your figure's entirely declaratively. This was the default syntax in the Plotly R library pre version 1.0.</p>

<pre><code>x0 = rnorm(500)
x1 = rnorm(500)+1

trace1 &lt;- list(x = x0, opacity = 0.75, type = "histogram")
trace2 &lt;- list(x = x1, opacity = 0.75, type = "histogram")
data &lt;- list(trace1, trace2)
layout &lt;- list(barmode = "overlay", title="overlaid histograms")

fig &lt;- list(data=data, layout=layout)

fig %>% offline</code></pre>

<h3>Offline with <code>knitr</code></h3>
<p>In knitr documents plotly graphs will be offline by default if the plotly offline libraries are installed.</p>

<br><p>To convert an <b>RMarkdown document to HTML</b>, do:</p>
<pre><code>knitr::knit_meta(clean=TRUE) # So that you can run this multiple times in a row. See https://github.com/ropensci/plotly/issues/271
knitr::knit('plotly-offline.Rmd', 'plotly-offline.md')
markdown::markdownToHTML('plotly-offline.md', 'plotly-offline.html')</code></pre>

<br>
<p>To print offline plots in a for loop, explicitly wrap the figure in <code>cat(knit_print.offline(offline(fig)))</code> and add <code>results="asis"</code> in the knitr block. Example:</p><br>
<pre><code>```{r, results="asis"}
for(i in 1:3) {
    fig &lt;- list(data=list(list(x=rnorm(100), type="histogram")), layout=list(title=paste(c('plot', i, sep=" "))))
    cat(knit_print.offline(fig %>% offline))
}
```</code></pre>

<h3>Offline with Shiny</h3>
<p>In Shiny apps plotly graphs will be offline by default if the plotly offline libraries are installed.</p>

<div>
  <h3 id="More-About-Plotly-Offline">More about plotly offline<a class="anchor-link" href="#More-About-Plotly-Offline">Â¶</a></h3>
    
    <ul>
        <li>Questions? <a href="mailto:support@plot.ly">support@plot.ly</a></li>
        
            <li><a href="https://plot.ly/r/">Examples and documentation</a></li>
        

        
            <li><a href="http://purchasing.plot.ly/">Purchase Plotly Offline</a></li>
        

        <li><a href="https://plot.ly/feed/">Graph gallery</a></li>
        <li><a href="https://plot.ly/product/enterprise/">Plotly server at your company</a></li>
    </ul>
</div>

</div>
</div>
</div>
{% endraw %}
