---
permalink: python/county-level-choropleth/
description: How to make a Choropleth Map of Florida in Python with Plotly.
name: Python County Level Choropleth | plotly
has_thumbnail: true
thumbnail: thumbnail/county-level-choropleth.jpg
layout: user-guide
name: County Level Choropleth
language: python
title: Python County Level Choropleth | plotly
display_as: maps
has_thumbnail: true
page_type: example_index
order: 1.5
---
{% raw %}
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="New-to-Plotly?">New to Plotly?<a class="anchor-link" href="#New-to-Plotly?">&#182;</a></h4><p>Plotly's Python library is free and open source! <a href="https://plot.ly/python/getting-started/">Get started</a> by dowloading the client and <a href="https://plot.ly/python/getting-started/">reading the primer</a>.
<br>You can set up Plotly to work in <a href="https://plot.ly/python/getting-started/#initialization-for-online-plotting">online</a> or <a href="https://plot.ly/python/getting-started/#initialization-for-offline-plotting">offline</a> mode, or in <a href="https://plot.ly/python/getting-started/#start-plotting-online">jupyter notebooks</a>.
<br>We also have a quick-reference <a href="https://images.plot.ly/plotly-documentation/images/python_cheat_sheet.pdf">cheatsheet</a> (new!) to help you get started!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">plotly</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[1]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&apos;1.12.4&apos;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this tutorial, we will be creating a choropleth of Florida's counties using <a href="http://codepen.io/">codepen</a>, and coloring the Republican and Democratic counties red and blue respectively.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Read-the-Data">Read the Data<a class="anchor-link" href="#Read-the-Data">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Read both a <a href="http://catalog.civicdashboards.com/dataset/cda82e8b-7a8b-411e-95ba-1200b921c35d/resource/5c5d19a0-b817-49e6-b76e-ea63a8e2c0f6/download/fd880c1e4d23463ca869f1122109b3eftemp.geojson">GeoJSON file</a> of the Florida counties and a <a href="http://dos.myflorida.com/elections/data-statistics/voter-registration-statistics/voter-registration-monthly-reports/voter-registration-current-by-county/">webpage</a> indicating Florida's voting registration by county</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">HTMLParser</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">&#39;http://catalog.civicdashboards.com/dataset/cda82e8b-7a8b-411e-95ba-1200b921c35d/resource/5c5d19a0-b817-49e6-b76e-ea63a8e2c0f6/download/fd880c1e4d23463ca869f1122109b3eftemp.geojson&#39;</span>
<span class="n">florida_data</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">florida_data</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">florida_data</span><span class="p">)</span>

<span class="n">repub_democ_counties_url</span> <span class="o">=</span> <span class="s">&#39;http://dos.myflorida.com/elections/data-statistics/voter-registration-statistics/voter-registration-monthly-reports/voter-registration-current-by-county/&#39;</span>
<span class="n">repub_democ_counties</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">repub_democ_counties_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we want to separate the counties into Republican and Democratic for our codepen script, and since the names in the GeoJSON contain more text for the <code>name</code> descriptions of each county than the website, we need to parse through and convert the names to the website format</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">county_names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">county_names_dict</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">county</span> <span class="ow">in</span> <span class="n">florida_data</span><span class="p">[</span><span class="s">&#39;features&#39;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">county</span><span class="p">[</span><span class="s">&#39;properties&#39;</span><span class="p">][</span><span class="s">&#39;name&#39;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">county</span><span class="p">[</span><span class="s">&#39;properties&#39;</span><span class="p">][</span><span class="s">&#39;name&#39;</span><span class="p">][</span><span class="n">m</span><span class="p">:</span><span class="n">m</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;County&#39;</span><span class="p">:</span>
            <span class="n">county_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">county</span><span class="p">[</span><span class="s">&#39;properties&#39;</span><span class="p">][</span><span class="s">&#39;name&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">county_names_dict</span><span class="p">[</span><span class="n">county</span><span class="p">[</span><span class="s">&#39;properties&#39;</span><span class="p">][</span><span class="s">&#39;name&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">county</span><span class="p">[</span><span class="s">&#39;properties&#39;</span><span class="p">][</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
            
<span class="k">print</span> <span class="n">county_names</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[&apos;Charlotte&apos;, &apos;Seminole&apos;, &apos;Baker&apos;, &apos;DeSoto&apos;, &apos;Levy&apos;, &apos;Alachua&apos;, &apos;Pasco&apos;, &apos;Hendry&apos;, &apos;Okeechobee&apos;, &apos;Broward&apos;, &apos;St. Johns&apos;, &apos;Gulf&apos;, &apos;Glades&apos;, &apos;Marion&apos;, &apos;Duval&apos;, &apos;Madison&apos;, &apos;Osceola&apos;, &apos;Lee&apos;, &apos;Volusia&apos;, &apos;Sarasota&apos;, &apos;Indian River&apos;, &apos;Clay&apos;, &apos;Putnam&apos;, &apos;Wakulla&apos;, &apos;Holmes&apos;, &apos;Escambia&apos;, &apos;Flagler&apos;, &apos;Union&apos;, &apos;Brevard&apos;, &apos;Suwannee&apos;, &apos;Orange&apos;, &apos;Martin&apos;, &apos;Nassau&apos;, &apos;Jefferson&apos;, &apos;Santa Rosa&apos;, &apos;Hamilton&apos;, &apos;Calhoun&apos;, &apos;Hernando&apos;, &apos;Miami-Dade&apos;, &apos;Pinellas&apos;, &apos;Palm Beach&apos;, &apos;Hillsborough&apos;, &apos;Collier&apos;, &apos;Gilchrist&apos;, &apos;Dixie&apos;, &apos;Bay&apos;, &apos;Gadsden&apos;, &apos;Okaloosa&apos;, &apos;Citrus&apos;, &apos;Lafayette&apos;, &apos;Manatee&apos;, &apos;Monroe&apos;, &apos;Columbia&apos;, &apos;Sumter&apos;, &apos;Washington&apos;, &apos;St. Lucie&apos;, &apos;Polk&apos;, &apos;Taylor&apos;, &apos;Leon&apos;, &apos;Lake&apos;, &apos;Highlands&apos;, &apos;Hardee&apos;, &apos;Bradford&apos;, &apos;Liberty&apos;, &apos;Franklin&apos;, &apos;Walton&apos;, &apos;Jackson&apos;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Color-the-Counties">Color the Counties<a class="anchor-link" href="#Color-the-Counties">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now run a script to color our counties based on political party. This involves parsing through our list of counties, finding their cooresponding Republican/Democratic votes on the website, and place our data into the cooresponding list <code>red_counties</code> or <code>blue_counties</code>, based on which party has more votes</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">red_counties</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">blue_counties</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">county</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">county_names</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">repub_democ_counties</span><span class="p">)):</span>
        <span class="n">county_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">county</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">repub_democ_counties</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="n">county_len</span><span class="p">]</span> <span class="o">==</span> <span class="n">string</span><span class="o">.</span><span class="n">upper</span><span class="p">(</span><span class="n">county</span><span class="p">):</span>
            <span class="n">new_j</span> <span class="o">=</span> <span class="n">j</span>

            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">repub_democ_counties</span><span class="p">[</span><span class="n">new_j</span><span class="p">])</span>
                    <span class="k">break</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">new_j</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">repub_votes</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">while</span> <span class="n">repub_democ_counties</span><span class="p">[</span><span class="n">new_j</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;&lt;&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">repub_democ_counties</span><span class="p">[</span><span class="n">new_j</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;,&#39;</span><span class="p">:</span>
            <span class="n">repub_votes</span> <span class="o">+=</span> <span class="n">repub_democ_counties</span><span class="p">[</span><span class="n">new_j</span><span class="p">]</span>
        <span class="n">new_j</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="c"># advance to next set of numbers</span>
    <span class="n">new_j</span> <span class="o">+=</span> <span class="mi">11</span>

    <span class="n">democ_votes</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">while</span> <span class="n">repub_democ_counties</span><span class="p">[</span><span class="n">new_j</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;&lt;&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">repub_democ_counties</span><span class="p">[</span><span class="n">new_j</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;,&#39;</span><span class="p">:</span>
            <span class="n">democ_votes</span> <span class="o">+=</span> <span class="n">repub_democ_counties</span><span class="p">[</span><span class="n">new_j</span><span class="p">]</span>
        <span class="n">new_j</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">repub_votes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">repub_votes</span><span class="p">)</span>
    <span class="n">democ_votes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">democ_votes</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">repub_votes</span> <span class="o">&gt;=</span> <span class="n">democ_votes</span><span class="p">:</span>
        <span class="n">red_counties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">florida_data</span><span class="p">[</span><span class="s">&#39;features&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">blue_counties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">florida_data</span><span class="p">[</span><span class="s">&#39;features&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Create-JSON-Files">Create JSON Files<a class="anchor-link" href="#Create-JSON-Files">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In <a href="https://github.com/plotly/datasets">plotly/datasets</a>, you can find the generated JSON files below for the <a href="https://raw.githubusercontent.com/plotly/datasets/master/florida-red-data.json">red counties</a> and <a href="https://raw.githubusercontent.com/plotly/datasets/master/florida-blue-data.json">blue counties</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">red_data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;FeatureCollection&quot;</span><span class="p">}</span>
<span class="n">red_data</span><span class="p">[</span><span class="s">&#39;features&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">red_counties</span>

<span class="n">blue_data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;FeatureCollection&quot;</span><span class="p">}</span>
<span class="n">blue_data</span><span class="p">[</span><span class="s">&#39;features&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blue_counties</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;florida-red-data.json&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">red_data</span><span class="p">))</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;florida-blue-data.json&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">blue_data</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Make-Choropleth-in-CodePen">Make Choropleth in CodePen<a class="anchor-link" href="#Make-Choropleth-in-CodePen">&#182;</a></h4>

</div>
</div>
</div>
<!--
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>

<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<p>You can access the choropleth at <a href="http://codepen.io/plotly/embed/vKWqxA/?height=604&theme-id=15263&default-tab=result">this link</a></p>
-->

 <p data-height="600" data-theme-id="0" data-slug-hash="vKWqxA" data-default-tab="result" data-user="plotly" data-embed-version="2" class="codepen">See the Pen <a href="http://codepen.io/plotly/pen/vKWqxA/">scattermapbox - MultiPoint</a> by plotly (<a href="http://codepen.io/plotly">@plotly</a>) on <a href="http://codepen.io">CodePen</a>.</p>
<script async src="//assets.codepen.io/assets/embed/ei.js"></script>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Reference">Reference<a class="anchor-link" href="#Reference">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See <a href="https://plot.ly/python/reference/#choropleth">https://plot.ly/python/reference/#choropleth</a> for more information and chart attribute options!</p>

</div>
</div>
</div>{% endraw %}