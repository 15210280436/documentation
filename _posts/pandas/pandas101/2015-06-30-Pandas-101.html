---
permalink: /pandas/intro-to-pandas-tutorial/
description: How to use Pandas, the Python data analysis tools, manipulate and analyse data in plotly.
name: Pandas 101 | plotly
has_thumbnail: false
thumbnail: /images/static-image
layout: user-guide
name: Pandas 101
language: pandas
title: Pandas 101 | plotly
has_thumbnail: false
page_type: u-guide
---
{% raw %}
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Installation">Installation<a class="anchor-link" href="#Installation">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pandas support Python's versions 2.7, 3.4, and 3.5.</p>
<p>Python will be required here. You can install it from the <a href="https://www.python.org/downloads/">source releases</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>PyPI Installation</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span>$ sudo pip install pandas
</pre></div>
<p>This will automatically download all the dependencies.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Linux Distribution Installation</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This commands will install Pandas for Python 2 from your distribution.</p>
<p>To install it for Python 3, you should use "<em>python3-pandas</em>" instead.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>Ubuntu &amp; Debian</strong></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span>$ sudo apt-get install python-pandas
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>Fedora &amp; OpenSuse</strong></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>zypper in  python-pandas</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It will install from "Official Debian Repository" and "OpenSuse Repository" respectively.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Anaconda Installation</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Anaconda is a cross-platform Python distribution for scientific computing and data analytics. (It makes the installation phase easy for beginners.)</p>
<p>You can get Anaconda from <a href="https://docs.continuum.io/anaconda/install">here</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can play with Pandas online at the IPython Notebook service by <a href="https://wakari.io/">Wakari</a>, without installing it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reading,-Writing,-and-Creating-data">Reading, Writing, and Creating data<a class="anchor-link" href="#Reading,-Writing,-and-Creating-data">&#182;</a></h3><p>Pandas let you use your data from multiple formats like CSV, EXCEL, JSON etc. You can use the data file on your local system or from an external URL.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Create data</strong></p>
<p>DataFrame is the most commonly used data-structure of Pandas, it's a 2-dimensional table like structure that can hold columns of multiple data-types. You can easily convert your Python lists into a DataFrame object.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">subjects</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mathematics&#39;</span><span class="p">,</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span> <span class="s1">&#39;History&#39;</span><span class="p">,</span> <span class="s1">&#39;Science&#39;</span><span class="p">,</span> <span class="s1">&#39;Arts&#39;</span><span class="p">]</span>
<span class="n">marks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">67</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">58</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the Python's <strong>zip</strong> function, we can merge these two <strong>list</strong> sequences into one.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">marks_dataset</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subjects</span><span class="p">,</span> <span class="n">marks</span><span class="p">)</span>
<span class="n">marks_dataset</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[4]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[(&apos;Mathematics&apos;, 67),
 (&apos;English&apos;, 60),
 (&apos;History&apos;, 36),
 (&apos;Science&apos;, 61),
 (&apos;Arts&apos;, 58)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">marks_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">marks_dataset</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Subjects&#39;</span><span class="p">,</span> <span class="s1">&#39;Marks&#39;</span><span class="p">])</span>
<span class="n">marks_df</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[5]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Subjects</th>
      <th>Marks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mathematics</td>
      <td>67</td>
    </tr>
    <tr>
      <th>1</th>
      <td>English</td>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>History</td>
      <td>36</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Science</td>
      <td>61</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arts</td>
      <td>58</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can also add a new column as shown in example below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">marks_df</span><span class="p">[</span><span class="s1">&#39;Result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">marks_df</span><span class="p">[</span><span class="s1">&#39;Marks&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;Pass&#39;</span><span class="p">,</span> <span class="s1">&#39;Fail&#39;</span><span class="p">)</span>
<span class="n">marks_df</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[6]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Subjects</th>
      <th>Marks</th>
      <th>Result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mathematics</td>
      <td>67</td>
      <td>Pass</td>
    </tr>
    <tr>
      <th>1</th>
      <td>English</td>
      <td>60</td>
      <td>Pass</td>
    </tr>
    <tr>
      <th>2</th>
      <td>History</td>
      <td>36</td>
      <td>Fail</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Science</td>
      <td>61</td>
      <td>Pass</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arts</td>
      <td>58</td>
      <td>Pass</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To delete a column (say 'Result'), we can use <strong><code>marks_df.pop('Result')</code></strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Write data</strong></p>
<p>We can write the <strong>DataFrame</strong> object to different file types.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">marks_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;marks.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The argument <strong>index=False</strong> is to prevent writing the index for each row (0...4) in file.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Read data</strong></p>
<p>Here, we will be using the <a href="https://gist.github.com/pravj/9ae9e67d10668c60545e2b858753415c">YouTube Channel Dataset.</a></p>
<p><strong>Note:- Some of the "Views" and "Comments" columns have missing values, represented as -1.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">channels_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;http://bit.ly/1rq29Xf&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Selecting-and-Filtering-dataframes">Selecting and Filtering dataframes<a class="anchor-link" href="#Selecting-and-Filtering-dataframes">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can use the describe mehod to show statistics of dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">channels_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[9]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>362.000000</td>
      <td>362.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>288.229282</td>
      <td>17.383978</td>
    </tr>
    <tr>
      <th>std</th>
      <td>147.604341</td>
      <td>12.479304</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.000000</td>
      <td>-1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>172.750000</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>295.500000</td>
      <td>14.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>399.000000</td>
      <td>26.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>533.000000</td>
      <td>54.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can replace the missing data values <strong>(-1)</strong> with <strong>NaN</strong> for some statistical ease.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">channels_df</span> <span class="o">=</span> <span class="n">channels_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>head</code> method select top 5 row for the dataframe. (<code>tail</code> method will return last 5 rows)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">channels_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[11]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WorldNews</td>
      <td>2015-01-01</td>
      <td>bob</td>
      <td>495.0</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WorldWeather</td>
      <td>2015-01-01</td>
      <td>emily</td>
      <td>191.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WorldNews</td>
      <td>2015-01-02</td>
      <td>bob</td>
      <td>293.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WorldWeather</td>
      <td>2015-01-02</td>
      <td>harry</td>
      <td>238.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>WorldNews</td>
      <td>2015-01-03</td>
      <td>alice</td>
      <td>509.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Select rows only for the 'WorldNews' channel.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span> <span class="o">=</span> <span class="n">channels_df</span><span class="p">[</span><span class="n">channels_df</span><span class="p">[</span><span class="s1">&#39;Channel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;WorldNews&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Select some sample rows from the new dataframe.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[13]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>82</th>
      <td>WorldNews</td>
      <td>2015-02-11</td>
      <td>bob</td>
      <td>432.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>246</th>
      <td>WorldNews</td>
      <td>2015-05-04</td>
      <td>alice</td>
      <td>294.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>126</th>
      <td>WorldNews</td>
      <td>2015-03-05</td>
      <td>jenn</td>
      <td>513.0</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Filter out the rows for 'WorldNews' channel having less than 100 views.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_less_views_df</span> <span class="o">=</span> <span class="n">worldnews_df</span><span class="p">[</span><span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Views&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Count the days when 'WorldNews' has received less than 100 views.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_less_views_df</span><span class="o">.</span><span class="n">size</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[15]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>105</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Indexing">Indexing<a class="anchor-link" href="#Indexing">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To get and set subsets of data object, Pandas supports 3 types of multi-axis indexing.</p>
<ul>
<li><strong>loc</strong><ul>
<li>It is based on the index <em>labels</em>.</li>
</ul>
</li>
<li><strong>iloc</strong><ul>
<li>It is based on the index <em>positions</em>, only integer values are accepted.</li>
</ul>
</li>
<li><strong>ix</strong><ul>
<li>Generally it behaves like <strong>loc</strong> but falls back to <strong>iloc</strong> when the label is not present in the index.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In our dataset the index contains only integer values, so all these methods will work similarly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Note:- The DataFrame <em>worldnews_df</em> contains only even integers in the index.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="o">.</span><span class="n">index</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[16]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>Int64Index([  0,   2,   4,   6,   8,  10,  12,  14,  16,  18,
            ...
            342, 344, 346, 348, 350, 352, 354, 356, 358, 360],
           dtype=&apos;int64&apos;, length=181)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Selection By Label</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the <strong>label based indexing</strong>, it follows <strong>strict inclusion</strong>.</p>
<p>For example <strong>[10:14]</strong> will look for every value in between 10 and 14 including both.</p>
<p><strong>At least 1</strong> labels should be present in the index, otherwise a <strong>KerError</strong> will be raised.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This will return the top <strong>3</strong> rows having index as 0, 2, and 4; Because it looks at the labels.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[17]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WorldNews</td>
      <td>2015-01-01</td>
      <td>bob</td>
      <td>495.0</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WorldNews</td>
      <td>2015-01-02</td>
      <td>bob</td>
      <td>293.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>WorldNews</td>
      <td>2015-01-03</td>
      <td>alice</td>
      <td>509.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Selection By Position</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the <strong>integer based indexing</strong>, it follows <strong>0-based</strong> slicing similar to Python lists that you are used to.</p>
<p>Where the starting bound is included but the upper bound is excluded.</p>
<p>Using a non-integer, even a valid label will raise a <strong>IndexError</strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Hence, this will return the top <strong>4</strong> rows, Because it looks at the positions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[18]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WorldNews</td>
      <td>2015-01-01</td>
      <td>bob</td>
      <td>495.0</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WorldNews</td>
      <td>2015-01-02</td>
      <td>bob</td>
      <td>293.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>WorldNews</td>
      <td>2015-01-03</td>
      <td>alice</td>
      <td>509.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>WorldNews</td>
      <td>2015-01-04</td>
      <td>alice</td>
      <td>490.0</td>
      <td>54.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This will work like <strong>loc</strong> because the index contains integer values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[19]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WorldNews</td>
      <td>2015-01-01</td>
      <td>bob</td>
      <td>495.0</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WorldNews</td>
      <td>2015-01-02</td>
      <td>bob</td>
      <td>293.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>WorldNews</td>
      <td>2015-01-03</td>
      <td>alice</td>
      <td>509.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Grouping,-Aggregating,-and-Pivoting-data">Grouping, Aggregating, and Pivoting data<a class="anchor-link" href="#Grouping,-Aggregating,-and-Pivoting-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Grouping</strong></p>
<p>We can group (combine) the dataset based on certain parameters. For example, here we are grouping the 'WorldNews' dataset based on their 'Anchor' columns.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_anchors_group</span> <span class="o">=</span> <span class="n">worldnews_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Anchor&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This will return a <strong>DataFrameGroupBy</strong> object.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">worldnews_anchors_group</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[21]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>pandas.core.groupby.DataFrameGroupBy</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Aggregating</strong></p>
<p>Aggregating the resultant group will count the respective 'Views' and 'Columns' for each anchor.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_anchors_group</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[22]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
    <tr>
      <th>Anchor</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>17498.0</td>
      <td>1227.0</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>17754.0</td>
      <td>821.0</td>
    </tr>
    <tr>
      <th>jenn</th>
      <td>16946.0</td>
      <td>888.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pivoting</strong></p>
<p>Using the pivot function, we can generate a new table from the original one.</p>
<p>It takes three arguments, that decides the <strong>index</strong>, <strong>columns</strong>, and <strong>cell values</strong> of the new table we want.</p>
<p>Consider this sample table for example.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[23]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>282</th>
      <td>WorldNews</td>
      <td>2015-05-22</td>
      <td>jenn</td>
      <td>200.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>186</th>
      <td>WorldNews</td>
      <td>2015-04-04</td>
      <td>alice</td>
      <td>114.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>WorldNews</td>
      <td>2015-01-11</td>
      <td>alice</td>
      <td>480.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>242</th>
      <td>WorldNews</td>
      <td>2015-05-02</td>
      <td>alice</td>
      <td>100.0</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>136</th>
      <td>WorldNews</td>
      <td>2015-03-10</td>
      <td>alice</td>
      <td>240.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>WorldNews</td>
      <td>2015-01-06</td>
      <td>jenn</td>
      <td>399.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>44</th>
      <td>WorldNews</td>
      <td>2015-01-23</td>
      <td>jenn</td>
      <td>72.0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>286</th>
      <td>WorldNews</td>
      <td>2015-05-24</td>
      <td>alice</td>
      <td>394.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>268</th>
      <td>WorldNews</td>
      <td>2015-05-15</td>
      <td>alice</td>
      <td>400.0</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>328</th>
      <td>WorldNews</td>
      <td>2015-06-14</td>
      <td>alice</td>
      <td>378.0</td>
      <td>36.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can try reshaping this table to find out how many 'Views' each anchor has received.</p>
<p>So we will create a new table whose 'index' is 'Date', 'columns' will be different values of 'Anchor column'.</p>
<p>The cell values will be the respective value of the 'Views' column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_pivoted_df</span> <span class="o">=</span> <span class="n">worldnews_df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Anchor&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Views&#39;</span><span class="p">)</span>
<span class="n">worldnews_pivoted_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[24]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Anchor</th>
      <th>alice</th>
      <th>bob</th>
      <th>jenn</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-06-04</th>
      <td>NaN</td>
      <td>113.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-04-07</th>
      <td>304.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-06-23</th>
      <td>NaN</td>
      <td>406.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-04-20</th>
      <td>NaN</td>
      <td>281.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-02-09</th>
      <td>NaN</td>
      <td>509.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-02-26</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>2015-03-02</th>
      <td>115.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-02-24</th>
      <td>NaN</td>
      <td>284.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-05-31</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>311.0</td>
    </tr>
    <tr>
      <th>2015-02-28</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>505.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is our derived table, you can see how many views different anchors have received.</p>
<p>Similarly you can reshape your tables according to your usecase.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Interpolation">Interpolation<a class="anchor-link" href="#Interpolation">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes your dataset has missing values in it.Pandas provide the <strong>interpolate</strong> function to insert data between fixed points. It uses different methods to regularize the missing values, by default it uses <strong>linear interpolation</strong> for the same.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can count the absent values (<strong>NaN</strong>) using the <strong>isnull</strong> method.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[25]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>Channel     0
Date        0
Anchor      0
Views       7
Comments    7
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's interpolate the Series object.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_interpolated_df</span> <span class="o">=</span> <span class="n">worldnews_df</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After interpolation, we can see that there are no more <strong>NaN</strong> values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_interpolated_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[27]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>Channel     0
Date        0
Anchor      0
Views       0
Comments    0
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Joining-data">Joining data<a class="anchor-link" href="#Joining-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pandas provides multiple methods to easily combine DataFrame and Series objects, like we see in SQL's join operations.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider these two small DataFrames.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">Adf</span> <span class="o">=</span> <span class="n">worldnews_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="n">Bdf</span> <span class="o">=</span> <span class="n">channels_df</span><span class="p">[</span><span class="n">channels_df</span><span class="p">[</span><span class="s1">&#39;Channel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;WorldWeather&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">Adf</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[29]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>WorldNews</td>
      <td>2015-01-04</td>
      <td>alice</td>
      <td>490.0</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>WorldNews</td>
      <td>2015-01-05</td>
      <td>bob</td>
      <td>231.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>WorldNews</td>
      <td>2015-01-06</td>
      <td>jenn</td>
      <td>399.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>WorldNews</td>
      <td>2015-01-07</td>
      <td>jenn</td>
      <td>463.0</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>WorldNews</td>
      <td>2015-01-08</td>
      <td>bob</td>
      <td>479.0</td>
      <td>27.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">Bdf</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[30]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>WorldWeather</td>
      <td>2015-01-06</td>
      <td>harry</td>
      <td>293.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>WorldWeather</td>
      <td>2015-01-07</td>
      <td>emily</td>
      <td>304.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>WorldWeather</td>
      <td>2015-01-08</td>
      <td>emily</td>
      <td>470.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>WorldWeather</td>
      <td>2015-01-09</td>
      <td>tom</td>
      <td>NaN</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>WorldWeather</td>
      <td>2015-01-10</td>
      <td>harry</td>
      <td>337.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Concat</strong></p>
<p>This function performs the concatenation operation along a given axis.</p>
<p><em>axis=0</em> means the operation will be performed along the <em>rows</em>, and for <em>axis=1</em> it will be along columns.</p>
<p>By default, it's acted along <em>rows</em>, ie <em>axis=0</em>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Adf</span><span class="p">,</span> <span class="n">Bdf</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[31]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>WorldNews</td>
      <td>2015-01-04</td>
      <td>alice</td>
      <td>490.0</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>WorldNews</td>
      <td>2015-01-05</td>
      <td>bob</td>
      <td>231.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>WorldNews</td>
      <td>2015-01-06</td>
      <td>jenn</td>
      <td>399.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>WorldNews</td>
      <td>2015-01-07</td>
      <td>jenn</td>
      <td>463.0</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>WorldNews</td>
      <td>2015-01-08</td>
      <td>bob</td>
      <td>479.0</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>WorldWeather</td>
      <td>2015-01-06</td>
      <td>harry</td>
      <td>293.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>WorldWeather</td>
      <td>2015-01-07</td>
      <td>emily</td>
      <td>304.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>WorldWeather</td>
      <td>2015-01-08</td>
      <td>emily</td>
      <td>470.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>WorldWeather</td>
      <td>2015-01-09</td>
      <td>tom</td>
      <td>NaN</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>WorldWeather</td>
      <td>2015-01-10</td>
      <td>harry</td>
      <td>337.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Adf</span><span class="p">,</span> <span class="n">Bdf</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[32]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
      <th>Channel</th>
      <th>Date</th>
      <th>Anchor</th>
      <th>Views</th>
      <th>Comments</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>WorldNews</td>
      <td>2015-01-04</td>
      <td>alice</td>
      <td>490.0</td>
      <td>54.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>WorldNews</td>
      <td>2015-01-05</td>
      <td>bob</td>
      <td>231.0</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>WorldNews</td>
      <td>2015-01-06</td>
      <td>jenn</td>
      <td>399.0</td>
      <td>17.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WorldWeather</td>
      <td>2015-01-06</td>
      <td>harry</td>
      <td>293.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>WorldNews</td>
      <td>2015-01-07</td>
      <td>jenn</td>
      <td>463.0</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WorldWeather</td>
      <td>2015-01-07</td>
      <td>emily</td>
      <td>304.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>WorldNews</td>
      <td>2015-01-08</td>
      <td>bob</td>
      <td>479.0</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WorldWeather</td>
      <td>2015-01-08</td>
      <td>emily</td>
      <td>470.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WorldWeather</td>
      <td>2015-01-09</td>
      <td>tom</td>
      <td>NaN</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WorldWeather</td>
      <td>2015-01-10</td>
      <td>harry</td>
      <td>337.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Join</strong></p>
<p>Pandas provides a single function, <strong>merge</strong>, for all standard join operations between DataFrame objects. We will look the basic arguments for this function.</p>
<div class="highlight"><pre><span></span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
<ul>
<li><strong>left</strong> - A DataFrame object</li>
<li><strong>right</strong> - Another DataFrame to combine with.</li>
<li><strong>how</strong> - Type of join operation, defaults to <em>inner</em>. Can be one of <em>left</em>, <em>right</em>, <em>inner</em>, and <em>outer</em>.</li>
<li><strong>on</strong> - Columns names on which the join operation will be performed. Must be available in both the left and right DataFrame.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Inner Join</strong></p>
<p>By default, <strong>join</strong> operates like the <strong>inner join</strong> of SQL. Here, we are performing the join on the 'Date' column.
Uses intersection of keys from both the DataFrames.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will get 3 rows because in the 'Date' columns there are only three matches.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">Adf</span><span class="p">,</span> <span class="n">Bdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[33]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel_x</th>
      <th>Date</th>
      <th>Anchor_x</th>
      <th>Views_x</th>
      <th>Comments_x</th>
      <th>Channel_y</th>
      <th>Anchor_y</th>
      <th>Views_y</th>
      <th>Comments_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WorldNews</td>
      <td>2015-01-06</td>
      <td>jenn</td>
      <td>399.0</td>
      <td>17.0</td>
      <td>WorldWeather</td>
      <td>harry</td>
      <td>293.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WorldNews</td>
      <td>2015-01-07</td>
      <td>jenn</td>
      <td>463.0</td>
      <td>26.0</td>
      <td>WorldWeather</td>
      <td>emily</td>
      <td>304.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WorldNews</td>
      <td>2015-01-08</td>
      <td>bob</td>
      <td>479.0</td>
      <td>27.0</td>
      <td>WorldWeather</td>
      <td>emily</td>
      <td>470.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Left Outer Join</strong></p>
<p>Uses the keys from left DataFrame only.</p>
<div class="highlight"><pre><span></span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that for the 'Date' values '2015-01-04' and '2015-01-05', there is not any corresponding matches <strong>(NaN)</strong> in the right DataFrame.</p>
<p>Because these rows are not present in the right DataFrame, <strong>Bdf</strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">Adf</span><span class="p">,</span> <span class="n">Bdf</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[34]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel_x</th>
      <th>Date</th>
      <th>Anchor_x</th>
      <th>Views_x</th>
      <th>Comments_x</th>
      <th>Channel_y</th>
      <th>Anchor_y</th>
      <th>Views_y</th>
      <th>Comments_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WorldNews</td>
      <td>2015-01-04</td>
      <td>alice</td>
      <td>490.0</td>
      <td>54.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WorldNews</td>
      <td>2015-01-05</td>
      <td>bob</td>
      <td>231.0</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WorldNews</td>
      <td>2015-01-06</td>
      <td>jenn</td>
      <td>399.0</td>
      <td>17.0</td>
      <td>WorldWeather</td>
      <td>harry</td>
      <td>293.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WorldNews</td>
      <td>2015-01-07</td>
      <td>jenn</td>
      <td>463.0</td>
      <td>26.0</td>
      <td>WorldWeather</td>
      <td>emily</td>
      <td>304.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>WorldNews</td>
      <td>2015-01-08</td>
      <td>bob</td>
      <td>479.0</td>
      <td>27.0</td>
      <td>WorldWeather</td>
      <td>emily</td>
      <td>470.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Right Outer Join</strong></p>
<p>Uses the keys from right DataFrame only.</p>
<div class="highlight"><pre><span></span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">Adf</span><span class="p">,</span> <span class="n">Bdf</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[35]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel_x</th>
      <th>Date</th>
      <th>Anchor_x</th>
      <th>Views_x</th>
      <th>Comments_x</th>
      <th>Channel_y</th>
      <th>Anchor_y</th>
      <th>Views_y</th>
      <th>Comments_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WorldNews</td>
      <td>2015-01-06</td>
      <td>jenn</td>
      <td>399.0</td>
      <td>17.0</td>
      <td>WorldWeather</td>
      <td>harry</td>
      <td>293.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WorldNews</td>
      <td>2015-01-07</td>
      <td>jenn</td>
      <td>463.0</td>
      <td>26.0</td>
      <td>WorldWeather</td>
      <td>emily</td>
      <td>304.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WorldNews</td>
      <td>2015-01-08</td>
      <td>bob</td>
      <td>479.0</td>
      <td>27.0</td>
      <td>WorldWeather</td>
      <td>emily</td>
      <td>470.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>2015-01-09</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WorldWeather</td>
      <td>tom</td>
      <td>NaN</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>2015-01-10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WorldWeather</td>
      <td>harry</td>
      <td>337.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Full Outer Join</strong></p>
<p>Uses the intersection of keys from both DataFrames.</p>
<div class="highlight"><pre><span></span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">Adf</span><span class="p">,</span> <span class="n">Bdf</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[36]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Channel_x</th>
      <th>Date</th>
      <th>Anchor_x</th>
      <th>Views_x</th>
      <th>Comments_x</th>
      <th>Channel_y</th>
      <th>Anchor_y</th>
      <th>Views_y</th>
      <th>Comments_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WorldNews</td>
      <td>2015-01-04</td>
      <td>alice</td>
      <td>490.0</td>
      <td>54.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WorldNews</td>
      <td>2015-01-05</td>
      <td>bob</td>
      <td>231.0</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WorldNews</td>
      <td>2015-01-06</td>
      <td>jenn</td>
      <td>399.0</td>
      <td>17.0</td>
      <td>WorldWeather</td>
      <td>harry</td>
      <td>293.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>WorldNews</td>
      <td>2015-01-07</td>
      <td>jenn</td>
      <td>463.0</td>
      <td>26.0</td>
      <td>WorldWeather</td>
      <td>emily</td>
      <td>304.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>WorldNews</td>
      <td>2015-01-08</td>
      <td>bob</td>
      <td>479.0</td>
      <td>27.0</td>
      <td>WorldWeather</td>
      <td>emily</td>
      <td>470.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>2015-01-09</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WorldWeather</td>
      <td>tom</td>
      <td>NaN</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>2015-01-10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WorldWeather</td>
      <td>harry</td>
      <td>337.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Cleaning-Data:-Dates,-Strings,-and-Formatting">Cleaning Data: Dates, Strings, and Formatting<a class="anchor-link" href="#Cleaning-Data:-Dates,-Strings,-and-Formatting">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We want our data to be in the cleanest form, so that we can use it further. For this, we need to get it in the desired structure, that's called cleaning the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Numerical Formatting</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Remember the interpolated DataFrame result? You can notice that the resultant values are <strong>Float64</strong> type.</p>
<p>Some of the values are like 11.5, 7.5 etc.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">worldnews_interpolated_df</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[37]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>numpy.float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we know that 'Views' or 'Comments' should be a perfect number by definition. We can format this by applying the <strong>ceil</strong> function on the 'Comments' column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_interpolated_df</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">worldnews_interpolated_df</span><span class="p">[</span><span class="s1">&#39;Comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That will map a number to the smallest integer greater than or equal to it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Dates Formatting</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the Series objects in the column 'Date' are 'str' types.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[39]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>str</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use the <strong>to_datetime</strong> function to convert them into 'Timestamp' type. The 'format' argument can be used to define the format of date in the 'Series', '2015-01-01' matches with '%Y-%m-%d'.</p>
<p>This can be used to timestamp related calculations.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[41]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>pandas.tslib.Timestamp</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pandas also provides functinoality equivalent to "datetime.timedelta", which is called "Timedelta".</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">time_a</span> <span class="o">=</span> <span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">time_b</span> <span class="o">=</span> <span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

<span class="n">time_diff</span> <span class="o">=</span> <span class="n">time_b</span> <span class="o">-</span> <span class="n">time_a</span>
<span class="nb">type</span><span class="p">(</span><span class="n">time_diff</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[42]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>pandas.tslib.Timedelta</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can collect different components of "Timedelta" object like "days", "hours", "minutes" etc.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">time_diff</span><span class="o">.</span><span class="n">components</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[43]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>Components(days=1, hours=0, minutes=0, seconds=0, milliseconds=0, microseconds=0, nanoseconds=0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>String Formatting</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pandas provide you a lot of <a href="http://pandas.pydata.org/pandas-docs/stable/api.html#string-handling">string formatting</a> methods. You can count the occurence of a particular pattern in a column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Anchor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;jenn&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[44]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>57</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the <strong>unique</strong> method you can check that different values in a column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can observe that the name of 'Anchor' is in smallcase.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Anchor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[45]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([&apos;bob&apos;, &apos;alice&apos;, &apos;jenn&apos;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the <strong>capitalize</strong> method, we can format the string values. There are other methods such as <strong>upper</strong>, <strong>lower</strong> etc.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Anchor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[46]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([&apos;Bob&apos;, &apos;Alice&apos;, &apos;Jenn&apos;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now suppose that there was a problem in data collection, the name of an anchor was "Matt" instead of "Bob".</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We do have a method for this situation too, <strong>replace</strong>. Taking arguments as the "pattern" and "expected replacing string".</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">worldnews_df</span><span class="p">[</span><span class="s1">&#39;Anchor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;bob&#39;</span><span class="p">,</span> <span class="s1">&#39;matt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[47]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([&apos;matt&apos;, &apos;alice&apos;, &apos;jenn&apos;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>{% endraw %}